<html>
<head>
  <meta charset="utf-8">
  <title>XPath-DOM Tests</title>
  <link href="vendor/mocha.css" rel="stylesheet" />
</head>
<body>
  <div id="test" style="display:none">
    <div>
      <h2>Header 2!</h2>
    </div>
    <div>Wot</div>
    <span>First span</span>
    <span>Second span</span>
    <h1>
      <span>
        Header!
      </span>
    </h1>
  </div>
  <div id="mocha"></div>

  <script src="vendor/chai.js"></script>
  <script src="vendor/mocha.js"></script>
  <script src="build/xpath-dom.js"></script>

  <script>
    mocha.setup('tdd');
    window.assert = chai.assert
  </script>
  <script src="/testem.js"></script>
  <script>
    suite('XPath-DOM', function() {
      suite('find', function() {
        test('finds elements relative to the body by default', function() {
          assert.equal('DIV', xpath.find("div").nodeName);
        });
        test('finds nested elements', function() {
          assert.equal('First span', xpath.find("div/span[1]").innerHTML);
          assert.equal('Second span', xpath.find("div/span[2]").innerHTML);
        });
        test('does not require [1] for the first element', function() {
          assert.equal('Header 2!', xpath.find("div/div/h2").innerHTML);
        });
      });
      suite('findAll', function() {
        test('returns an array of multiple elements', function() {
          assert.isArray(xpath.findAll("div/span"));
          assert.equal('First span', xpath.findAll("div/span")[0].innerHTML);
          assert.equal('Second span', xpath.findAll("div/span")[1].innerHTML);
        });
        test('allows for overriding the default root', function() {
          assert.equal('Second span', xpath.findAll('span', xpath.findAll("div")[0])[1].innerHTML);
          assert.equal(0, xpath.findAll('span').length);
        });
      });

      suite('getXPath', function() {
        test('converts a node into an xpath', function() {
          assert.equal('div', xpath.getXPath(xpath.find("div")));
        });
        test('gets nested nodes', function() {
          assert.equal('div/h1/span', xpath.getXPath(xpath.find("div/h1/span")));
        });
        test('gets siblings', function() {
          assert.equal('div/span[2]', xpath.getXPath(xpath.find("div/span[2]")));
        });
        test('leaves out [1]', function() {
          assert.equal('div/span', xpath.getXPath(xpath.find("div/span[1]")));
        });
      });
    });
  </script>
  <script>
    mocha.checkLeaks();
    mocha.run();
  </script>
</body>
</html>
